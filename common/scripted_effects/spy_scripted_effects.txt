removeOpFlagsAlpha_F = {
	remove_country_flag = saboRep
	remove_country_flag = studyTech
	remove_country_flag = fundCrime
	remove_country_flag = swingEthics
	remove_country_flag = sowUnrest
	remove_country_flag = sabStation

}
removeOpFlagsBeta_F = {
	remove_country_flag = saboRep2
	remove_country_flag = studyTech2
	remove_country_flag = fundCrime2
	remove_country_flag = swingEthics2
	remove_country_flag = sowUnrest2
	remove_country_flag = sabStation2
}
removeOpFlagsAlpha_D = {
	remove_country_flag = boostRepA
	remove_country_flag = stopCrimeA
	remove_country_flag = boostEthicA
}
removeOpFlagsBeta_D = {
	remove_country_flag = boostRepB
	remove_country_flag = stopCrimeB
	remove_country_flag = boostEthicB
}



removeIntelPointsAlpha = {
	while = {
		limit = {
			has_resource = { type = sr_alpha_points amount > 0 }
		}
		add_resource = { sr_alpha_points = -1 }
	}
	while = { #had a bug that resources over 100 wouldnt completly deplete, instead of being a good programmer and discovering the cause, i just run this twice.
		limit = {
			has_resource = { type = sr_alpha_points amount > 0 }
		}
		add_resource = { sr_alpha_points = -1 }
	}
}
removeIntelPointsBeta = {
	while = {
		limit = {
			has_resource = { type = sr_beta_points amount > 0 }
		}
		add_resource = { sr_beta_points = -1 }
	}
	while = { #had a bug that resources over 100 wouldnt completly deplete, instead of being a good programmer and discovering the cause, i just run this twice.
		limit = {
			has_resource = { type = sr_beta_points amount > 0 }
		}
		add_resource = { sr_beta_points = -1 }
	}
}



#### FUND CRIME FUNCTIONS ####
removeFundCrimeFlags_Beta = { 
	remove_country_flag = fundCrime2
	remove_country_flag = fundCrime_hold_level_B
	remove_country_flag = fundCrime_level_1_B
	remove_country_flag = fundCrime_level_2_B
	remove_country_flag = fundCrime_level_3_B
}
removeFundCrimeFlags_Alpha = {
	remove_country_flag = fundCrime
	remove_country_flag = fundCrime_hold_level
	remove_country_flag = fundCrime_level_1_A
	remove_country_flag = fundCrime_level_2_A
	remove_country_flag = fundCrime_level_3_A
}

#### SWING ETHICS FUNCTIONS ####
removeSwingEthicsFlags_Alpha = {
	remove_country_flag = swingAuthoritarian
	remove_country_flag = swingEgalitarian
	remove_country_flag = swingMaterialist
	remove_country_flag = swingMilitarist
	remove_country_flag = swingPacifist
	remove_country_flag = swingSpiritualist
	remove_country_flag = swingXenophile
	remove_country_flag = swingXenophobe
	remove_country_flag = swingEthics
}
removeSwingEthicsFlags_Beta = {
	remove_country_flag = swingAuthoritarian2
	remove_country_flag = swingEgalitarian2
	remove_country_flag = swingMaterialist2
	remove_country_flag = swingMilitarist2
	remove_country_flag = swingPacifist2
	remove_country_flag = swingSpiritualist2
	remove_country_flag = swingXenophile2
	remove_country_flag = swingXenophobe2
	remove_country_flag = swingEthics2
}


#### GATHER PROGRESS FUNCTIONS ####
removeGatherProgress_Alpha_F = {
	remove_country_flag = gatherProgress_1
	remove_country_flag = gatherProgress_2
	remove_country_flag = gatherProgress_3
	remove_country_flag = gatherProgress_4
	remove_country_flag = gatherProgress_5
	remove_country_flag = gatherProgress_6
}
removeGatherProgress_Beta_F = {
	remove_country_flag = gatherProgress_1_2
	remove_country_flag = gatherProgress_2_2
	remove_country_flag = gatherProgress_3_2
	remove_country_flag = gatherProgress_4_2
	remove_country_flag = gatherProgress_5_2
	remove_country_flag = gatherProgress_6_2
}
removeGatherProgress_Alpha_D = {
	remove_country_flag = gatherProgress_1_03
	remove_country_flag = gatherProgress_2_03
	remove_country_flag = gatherProgress_3_03
	remove_country_flag = gatherProgress_4_03
	remove_country_flag = gatherProgress_5_03
	remove_country_flag = gatherProgress_6_03
}
removeGatherProgress_Beta_D = {
	remove_country_flag = gatherProgress_1_04
	remove_country_flag = gatherProgress_2_04
	remove_country_flag = gatherProgress_3_04
	remove_country_flag = gatherProgress_4_04
	remove_country_flag = gatherProgress_5_04
	remove_country_flag = gatherProgress_6_04
}


#### SPY FAIL EVENTS ####
### RETURN TO INTEL GATHERING ###
spyFailReturnToIntelGather = {
	if = {
		limit = {
			has_country_flag = saboRep
		}
		remove_country_flag = saboRep
	}
	else_if = {
		limit = {
			has_country_flag = swingEthics
		}
		remove_country_flag = swingEthics
	}
	else_if = {
		limit = {
			has_country_flag = fundCrime
		}
		remove_country_flag = fundCrime
	}
	else_if = {
		limit = {
			has_country_flag = sowUnrest
		}
		remove_country_flag = sowUnrest
	}
	else_if = {
		limit = {
			has_country_flag = studyTech
		}
		remove_country_flag = studyTech
	}
	else_if = {
		limit = {
			has_country_flag = sabStation
		}
		remove_country_flag = sabStation
	}
	set_country_flag = gatherIntelAlpha
	country_event = {
		id = progressTrackerA.1
	}
}
spyFailReturnToIntelGather_B = {
	if = {
		limit = {
			has_country_flag = saboRep2
		}
		remove_country_flag = saboRep2
	}
	else_if = {
		limit = {
			has_country_flag = swingEthics2
		}
		remove_country_flag = swingEthics2
	}
	else_if = {
		limit = {
			has_country_flag = fundCrime2
		}
		remove_country_flag = fundCrime2
	}
	else_if = {
		limit = {
			has_country_flag = sowUnrest2
		}
		remove_country_flag = sowUnrest2
	}
	else_if = {
		limit = {
			has_country_flag = studyTech2
		}
		remove_country_flag = studyTech2
	}
	else_if = {
		limit = {
			has_country_flag = sabStation2
		}
		remove_country_flag = sabStation2
	}
	set_country_flag = gatherIntelBeta
	country_event = {
		id = progressTrackerB.1
	}	
}


spyFailRedoOperation = {
	removeGatherProgress_Alpha_F = yes
	country_event = {
		id = progressTrackerA.1
	}
}
spyFailRedoOperation_B = {
	removeGatherProgress_Beta_F = yes
	country_event = {
		id = progressTrackerB.1
	}
}



### DETERMINE TARGET TECH LEVEL, GET REWARD LEVEL ###
determineTargetTechLevel = {
	if = {
		limit = {
			relative_power = {
				who = event_target:alphaNetworkTarget_temp 
				category = technology
				value >= overwhelming
			}
		}
		if = {
			limit = {
				has_country_flag = getGenericEng
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = 24
				min = 150
				max = 500
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericPhys
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = 24
				min = 150
				max = 500
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericSoc
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 24
				min = 150
				max = 500
		  	}
		}
	}
	else_if = {
		limit = {
			relative_power = {
				who = event_target:alphaNetworkTarget_temp 
				category = technology
				value >= superior
			}
		}
		if = {
			limit = {
				has_country_flag = getGenericEng
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = 18
				min = 120
				max = 350
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericPhys
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = 18
				min = 120
				max = 350
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericSoc
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 18
				min = 120
				max = 350
		  	}
		}
	}

	else_if = {
		limit = {
			relative_power = {
				who = event_target:alphaNetworkTarget_temp 
				category = technology
				value >= equivalent
			}
		}
		if = {
			limit = {
				has_country_flag = getGenericEng
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = 12
				min = 90
				max = 250
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericPhys
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = 12
				min = 90
				max = 250
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericSoc
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 12
				min = 90
				max = 250
		  	}
		}
	}
	else_if = {
		limit = {
			relative_power = {
				who = event_target:alphaNetworkTarget_temp 
				category = technology
				value >= inferior
			}
		}
		if = {
			limit = {
				has_country_flag = getGenericEng
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = 6
				min = 60
				max = 150
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericPhys
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = 6
				min = 60
				max = 150
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericSoc
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 6
				min = 60
				max = 150
		  	}
		}
	}
	else_if = {
		limit = {
			relative_power = {
				who = event_target:alphaNetworkTarget_temp 
				category = technology
				value >= pathetic
			}
		}
		if = {
			limit = {
				has_country_flag = getGenericEng
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = 1
				min = 10
				max = 30
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericPhys
			}
			add_monthly_resource_mult = {
				resource = physics_research
				value = 1
				min = 10
				max = 30
		  	}
		}
		else_if = {
			limit = {
				has_country_flag = getGenericSoc
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 1
				min = 10
				max = 30
		  	}
		}
	}
}


 










# GET COUNTER INTEL LEVEL FOR ALPHA TARGET
getCounterIntelLevelTargetAlpha = {
	if = {
		limit = {
			event_target:alphaNetworkTarget_temp = {
				or = {
					has_country_flag = AI_Defence_Double
					and = {
						has_country_flag = Alpha_Defence
						has_country_flag = Beta_Defence
					}
				}
			}
		}
		set_variable = {
			which = defenceLevelVarAlpha
			value = 3 #HIGH
		}
	}
	else_if = {
		limit = {
			event_target:alphaNetworkTarget_temp = {
				or = {
					has_country_flag = AI_Defence_Single
					has_country_flag = Alpha_Defence
					has_country_flag = Beta_Defence
				}
			}
		}
		set_variable = {
			which = defenceLevelVarAlpha
			value = 2 #MEDIUM
		}
	}
	else_if = {
		limit = {
			event_target:alphaNetworkTarget_temp = {
				nor = {
					has_country_flag = AI_Defence_Single
					has_country_flag = AI_Defence_Double
					has_country_flag = Alpha_Defence
					has_country_flag = Beta_Defence
				}
			}
		}
		set_variable = {
			which = defenceLevelVarAlpha
			value = 1 #LOW
		}
	}

	##### CALCULATE POLICY EFFECTS #####
	
	if = { #INCREASES BY ONE FOR DEFENSIVE FOCUS POLICY
		limit = {
			event_target:alphaNetworkTarget_temp = {
				has_policy_flag = spy_defensive_focus
			}
		}
		change_variable = {
			which = defenceLevelVarAlpha
			value = 1
		}
	}
	if = { #DECREASES BY ONE FOR OFFENSIVE FOCUS POLICY
		limit = {
			event_target:alphaNetworkTarget_temp = {
				has_policy_flag = spy_offensive_focus
			}
		}
		subtract_variable = {
			which = defenceLevelVarAlpha
			value = 1
		}
	}
}


# GET COUNTER INTEL LEVEL FOR BETA TARGET
getCounterIntelLevelTargetBeta = {
	if = {
		limit = {
			event_target:betaNetworkTarget_temp = {
				or = {
					has_country_flag = AI_Defence_Double
					and = {
						has_country_flag = Alpha_Defence
						has_country_flag = Beta_Defence
					}
				}
			}
		}
		set_variable = {
			which = defenceLevelVarBeta
			value = 3 #MEDIUM
		}
	}
	else_if = {
		limit = {
			event_target:betaNetworkTarget_temp = {
				or = {
					has_country_flag = AI_Defence_Single
					has_country_flag = Alpha_Defence
					has_country_flag = Beta_Defence
				}
			}
		}
		set_variable = {
			which = defenceLevelVarBeta
			value = 2 #LOW
		}
	}
	else_if = {
		limit = {
			event_target:betaNetworkTarget_temp = {
				nor = {
					has_country_flag = AI_Defence_Single
					has_country_flag = AI_Defence_Double
					has_country_flag = Alpha_Defence
					has_country_flag = Beta_Defence
				}
			}
		}
		set_variable = {
			which = defenceLevelVarBeta
			value = 1 #NONE
		}
	}

	##### CALCULATE POLICY EFFECTS #####

	if = { #INCREASES BY ONE FOR DEFENSIVE FOCUS POLICY
		limit = {
			event_target:betaNetworkTarget_temp = {
				has_policy_flag = spy_defensive_focus
			}
		}
		change_variable = {
			which = defenceLevelVarBeta
			value = 1
		}
	}
	if = { #DECREASES BY ONE FOR OFFENSIVE FOCUS POLICY
		limit = {
			event_target:betaNetworkTarget_temp = {
				has_policy_flag = spy_offensive_focus
			}
		}
		subtract_variable = {
			which = defenceLevelVarBeta
			value = 1
		}
	}
}






# GET COUNTER INTEL LEVEL FOR AI TARGET
getCounterIntelLevelTargetAI = {
	if = {
		limit = {
			event_target:AIAgency_Defender_Final = {
				or = {
					has_country_flag = AI_Defence_Double
					and = {
						has_country_flag = Alpha_Defence
						has_country_flag = Beta_Defence
					}
				}
			}
		}
		set_variable = {
			which = defenceLevelVarAI
			value = 3 #MEDIUM
		}
	}
	else_if = {
		limit = {
			event_target:AIAgency_Defender_Final = {
				or = {
					has_country_flag = AI_Defence_Single
					has_country_flag = Alpha_Defence
					has_country_flag = Beta_Defence
				}
			}
		}
		set_variable = {
			which = defenceLevelVarAI
			value = 2 #LOW
		}
	}
	else_if = {
		limit = {
			event_target:AIAgency_Defender_Final = {
				nor = {
					has_country_flag = AI_Defence_Single
					has_country_flag = AI_Defence_Double
					has_country_flag = Alpha_Defence
					has_country_flag = Beta_Defence
				}
			}
		}
		set_variable = {
			which = defenceLevelVarAI
			value = 1 #NONE
		}
	}

	##### CALCULATE POLICY EFFECTS #####

	if = { #INCREASES BY ONE FOR DEFENSIVE FOCUS POLICY
		limit = {
			event_target:AIAgency_Defender_Final = {
				has_policy_flag = spy_defensive_focus
			}
		}
		change_variable = {
			which = defenceLevelVarAI
			value = 1
		}
	}
	if = { #DECREASES BY ONE FOR OFFENSIVE FOCUS POLICY
		limit = {
			event_target:AIAgency_Defender_Final = {
				has_policy_flag = spy_offensive_focus
			}
		}
		subtract_variable = {
			which = defenceLevelVarAI
			value = 1
		}
	}
}