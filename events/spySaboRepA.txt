namespace = saboRep

country_event = {  #SUCCESS/FAIL ROLL EVENT
    id = saboRep.1
    is_triggered_only = yes
    hide_window = yes
    immediate = {
        random_list = { #CHECKS FOR CRIT
            # 10 = { #crit table
            #     country_event = { id = sabRepCrit.1 days = 1 }
            # }

            40 = { #standard table
                random_list = {
                    50 = {
                        country_event = { id = saboRep.2 } #FULL SUCCESS
                    }
                    50 = {
                        country_event = { id = saboRep.3 } #PARTIAL SUCCESS
                    }
                }
            }   
        }
    }
}

#### FULL SUCCESS #####
country_event = {
	id = saboRep.2
	title = "sabotageRepSuccess.title"
	desc = "sabotageRepSuccess.desc"
	show_sound = event_conversation
	is_triggered_only = yes
    picture = GFX_evt_alien_segregation


    immediate = {
        save_event_target_as = playerAgency
        event_target:alphaNetworkTarget_temp = {
            every_country = {
                limit = {
                    checkCountryType = yes
                    has_communications = event_target:alphaNetworkTarget_temp
                    not = {
                        is_same_value = event_target:playerAgency
                    }
                }
                add_opinion_modifier = {
                    who = event_target:alphaNetworkTarget_temp
                    modifier = opinion_saboRep_high
                }
            }
        }
        if = {
            limit = {
                event_target:alphaNetworkTarget_temp = {
                    is_ai = no
                }
            }
            event_target:alphaNetworkTarget_temp = {
                random_list = {
                    30 = {
                        create_message = {
                            type = EVENT_MESSAGE_TYPE
                            localization = SABREP_NOTE_1_MESSAGE 
                            days = @messageDisplayLength
                            target = event_target:alphaNetworkTarget_temp
                        }
                    }
                    30 = {
                        create_message = {
                            type = EVENT_MESSAGE_TYPE
                            localization = SABREP_NOTE_2_MESSAGE 
                            days = @messageDisplayLength
                            target = event_target:alphaNetworkTarget_temp
                        }
                    }
                    30 = {
                        create_message = {
                            type = EVENT_MESSAGE_TYPE
                            localization = SABREP_NOTE_3_MESSAGE 
                            days = @messageDisplayLength
                            target = event_target:alphaNetworkTarget_temp
                        }
                    }
                }
            }
        }
    }

    option = { #REDO 
        name = sabotageRepSuccess.a
        custom_tooltip = pointsRequiredAlpha.tooltip
        allow = {
            hidden_trigger = {
                has_resource = { type = sr_alpha_points amount >= @operationCostCheck } 
			}
        }
        hidden_effect = {
            removeGatherProgress_Alpha_F = yes
            country_event = {
                id = progressTrackerA.1
            }
        }
    }

    option = { #RETURN TO INTEL GATHERING
        name = sabotageRepSuccess.b
        hidden_effect = {
            remove_country_flag = saboRep 
            set_country_flag = gatherIntelAlpha 
            country_event = {
                id = progressTrackerA.1
                
            }
        }
    }
}




#### PARTIAL SUCCESS #####
country_event = {
	id = saboRep.3
	title = "sabotageRepSuccessPartial.title"
	desc = "sabotageRepSuccessPartial.desc"
	show_sound = event_conversation
	is_triggered_only = yes
    picture = GFX_evt_alien_segregation

    immediate = {
        save_event_target_as = playerAgency

        event_target:alphaNetworkTarget_temp = {
            every_neighbor_country = {
                limit = {
                    checkCountryType = yes
                    has_communications = event_target:alphaNetworkTarget_temp
                    not = {
                        is_same_value = event_target:playerAgency
                    }
                }
                add_opinion_modifier = {
                    who = event_target:alphaNetworkTarget_temp
                    modifier = opinion_saboRep_low
                }
            }
        }
        if = {
            limit = {
                event_target:alphaNetworkTarget_temp = {
                    is_ai = no
                }
            }
            event_target:alphaNetworkTarget_temp = {
                random_list = {
                    30 = {
                        create_message = {
                            type = EVENT_MESSAGE_TYPE
                            localization = SABREP_NOTE_1_MESSAGE 
                            days = @messageDisplayLength
                            target = event_target:alphaNetworkTarget_temp
                        }
                    }
                    30 = {
                        create_message = {
                            type = EVENT_MESSAGE_TYPE
                            localization = SABREP_NOTE_2_MESSAGE 
                            days = @messageDisplayLength
                            target = event_target:alphaNetworkTarget_temp
                        }
                    }
                    30 = {
                        create_message = {
                            type = EVENT_MESSAGE_TYPE
                            localization = SABREP_NOTE_3_MESSAGE 
                            days = @messageDisplayLength
                            target = event_target:alphaNetworkTarget_temp
                        }
                    }
                }
            }
        }
    }
    option = { #REDO
        name = sabotageRepSuccess.a
        custom_tooltip = pointsRequiredAlpha.tooltip
        allow = {
            hidden_trigger = {
                has_resource = { type = sr_alpha_points amount >= @operationCostCheck } 
			}
        }
        hidden_effect = {
            removeGatherProgress_Alpha_F = yes
            country_event = {
                id = progressTrackerA.1
            }
        }
    }


    option = { #RETURN TO INTEL GATHERING
        name = sabotageRepSuccess.b
        hidden_effect = {
            remove_country_flag = saboRep
            set_country_flag = gatherIntelAlpha
            country_event = {
                id = progressTrackerA.1
                
            }
        }
    }
}







#### BLACKMAIL DIPLOMAT #####
	## OPENING EVENT ##
    @eventDayLength = 20
    @eventRandomLength = 10
    country_event = {
        id = saboRep.5 
        title = saboRep.5.name
        desc = {
            text = saboRep.5.desc
            trigger = { }
        }
        is_triggered_only = yes
        picture = GFX_evt_debris
        show_sound = event_default
        
        immediate = { }

        # CHOICE A
        option = {
            name = saboRep.5.a
            hidden_effect = {
                random_list = {
                    50 = {
                        save_event_target_as = stageOneChoiceA_Success
                    }
                    50 = {
                        save_event_target_as = stageOneChoiceA_Fail
                    }
                }
                country_event = { 
                    id = saboRep.6 
                    days = @eventDayLength random = @eventRandomLength 
                }
            }
        }

        # CHOICE B
        option = {
            name = saboRep.5.b
            hidden_effect = {
                random_list = {
                    50 = {
                        save_event_target_as = stageOneChoiceB_Success
                    }
                    50 = {
                        save_event_target_as = stageOneChoiceB_Fail
                    }
                }
                country_event = { 
                    id = saboRep.6 
                    days = @eventDayLength random = @eventRandomLength 
                }
            }
        }
    }


## FINAL STAGE ##
    country_event = {
        id = saboRep.6
        title = saboRep.6.name
        desc = { # CHOICE A WON
            text = saboRep.6.desc.a
            trigger = {
                is_same_value = event_target:stageOneChoiceA_Success
            }
        }
        desc = { # CHOICE A FAIL
            text = saboRep.6.desc.b
            trigger = {
                is_same_value = event_target:stageOneChoiceA_Fail
            }
        }
        desc = { # CHOICE B WON
            text = saboRep.6.desc.c
            trigger = {
                is_same_value = event_target:stageOneChoiceB_Success
            }
        }
        desc = { # CHOICE B FAIL
            text = saboRep.6.desc.d
            trigger = {
                is_same_value = event_target:stageOneChoiceB_Fail
            }
        }
        is_triggered_only = yes
        picture = GFX_evt_debris
        show_sound = event_default
        
        immediate = { }

        # END
        option = {
            name = saboRep.6.a
            hidden_effect = { }
        }
    }